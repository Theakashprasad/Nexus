<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PRODUCT</title>
  <link rel="icon" type="image/x-icon" href="/image/icons8-n-50.png">
<link rel="stylesheet" href="/dist/output.css">
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
<script type="text/javascript" src="https://cdn.rawgit.com/igorlino/elevatezoom-plus/1.1.6/src/jquery.ez-plus.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">  

<style>
  .hidden {
    display: none;
  }
</style>


</head> 

<body class="w-screen overflow-x-hidden">
  <!-- nav bar -->
<%- include('../partials/navbar.ejs') %>

    <!-- product page -->
  <section class="py-10 pt-32 font-poppins dark:bg-gray-100">
    <div class="max-w-6xl mx-auto">
      <div class="flex flex-wrap mb-24 -mx-4">
        
      <div class="w-full px-4 mb-8 md:w-1/2 md:mb-0">
        <div class="sticky top-0 overflow-hidden ">

            <!-- main image -->
            <div class="relative mb-6 lg:mb-10 lg:h-96">
                <img id="mainImage" data-fade-in="css-147n82m" class="css-viwop1 object-contain w-full lg:h-full"css-147n82m" src="<%=user.product_img_url[0].replace(/\\/g, '/')%>"  alt="Nike Vomero 5 Men's Shoes" style="object-fit: contain;">
            </div>

            <!-- rest of the images -->
            <div class=" flex-wrap hidden -mx-2 md:flex">
                <div class="w-1/2 p-2 sm:w-1/4">
                    <a class="block border border-gray-200 hover:border-blue-400 dark:border-gray-700 dark:hover:border-blue-300" href="#">
                        <img data-fade-in="css-147n82m" class="css-viwop1 u-full-width u-full-height css-147n82m"  src="<%=user.product_img_url[1].replace(/\\/g, '/')%>"  alt="Nike Vomero 5 Men's Shoes" style="object-fit: contain;">                    </a>
                    </a>
                </div>
                <div class="w-1/2 p-2 sm:w-1/4">  
                    <a class="block border border-gray-200 hover:border-blue-400 dark:border-gray-700 dark:hover:border-blue-300" href="#">
                        <img data-fade-in="css-147n82m" class=" css-viwop1  css-m5dkrx" src="<%=user.product_img_url[2].replace(/\\/g, '/')%>"  alt="Nike Vomero 5 Men's Shoes" style="object-fit: contain;">
                    </a>
                </div>
                <div class="w-1/2 p-2 sm:w-1/4">
                    <a class="block border border-gray-200 hover:border-blue-400 dark:border-gray-700 dark:hover:border-blue-300" href="#">
                        <img data-fade-in="css-147n82m" class="css-viwop1 u-full-width u-full-height css-147n82m" src="<%=user.product_img_url[3].replace(/\\/g, '/')%>" alt="Nike Vomero 5 Men's Shoes" style="object-fit: contain;">  </a>
                    </a>
                </div>
                <div class="w-1/2 p-2 sm:w-1/4">
                    <a class="block border border-gray-200 hover:border-blue-400 dark:border-gray-700 dark:hover:border-blue-300" href="#">
                        <img data-fade-in="css-147n82m" class="css-viwop1 u-full-width u-full-height css-147n82m" src="<%=user.product_img_url[0].replace(/\\/g, '/')%>" alt="Nike Vomero 5 Men's Shoes" style="object-fit: contain;">                    </a>
                    </a>
                </div>
            </div>
        </div>
    </div>

<!-- about product -->

    <div class="w-full px-4 md:w-1/2">
    <div class="lg:pl-20">

    <div class="mb-6 ">
    <span class="px-2.5 py-0.5 text-xs text-blue-600 bg-blue-100 dark:bg-blue-700 rounded-xl dark:text-gray-200"> NewArrival </span>
    <h2 class="max-w-xl mt-6 mb-6 text-xl font-extrabold leading-loose tracking-wide text-gray-700 md:text-2xl "><%= user.product_name %> </h2>
    <p class="text-lg font-semibold text-gray-900 dark:text-gray-500 cursor-auto my-3"> <%=user.product_category%></p>
    <p class="inline-block text-2xl font-semibold text-gray-700 dark:text-gray-400 ">
    <p id="productPrice" >$ <%=user.product_price %></p>
    <span class="ml-3 text-base font-normal text-gray-500 line-through dark:text-gray-400">$<%=user.product_price*1.2 %></span></p>
   </div>
  
    <div class="mb-6">
    <h2 class="mb-2 text-lg font-bold text-gray-700 dark:text-gray-400">System Specs :</h2>
    <div class="bg-gray-400 dark:bg-gray-4  00 rounded-xl">
    <div class="p-3 lg:p-5 ">
    <div class="p-2 rounded-xl lg:p-6 dark:bg-gray-300 bg-gray-50">

    <div>
        <div class="mt-5">
            <div class="flex items-center justify-between">
              <h4 class="text-sm font-medium text-gray-900">Size</h4>
            </div>

            <fieldset class="mt-4">
              <legend class="sr-only">Choose a size</legend>
              <div class="grid grid-cols-4 gap-4">
                
                  <label class="group relative flex items-center justify-center rounded-md border py-3 px-4 text-sm font-medium uppercase hover:bg-gray-50 focus:outline-none sm:flex-1 cursor-pointer <%= user.size[0] === 0 ? ' border-red-500 bg-gray-200 text-gray-400' : 'bg-gray-400 text-gray-900 ' %> shadow-sm">
                  <input  type="radio" name="size-choice" value="0" class="sr-only" aria-labelledby="size-choice-0-label"   <%=user.size[0]<=0 ? 'disabled="disabled"':'' %> >
                  <span id="size-choice-0-label">6</span>
                  <span class="pointer-events-none absolute -inset-px rounded-md" aria-hidden="true"></span>
                </label>

                <label class="group relative flex items-center justify-center rounded-md border py-3 px-4 text-sm font-medium uppercase hover:bg-gray-50 focus:outline-none sm:flex-1 cursor-pointer <%= user.size[1] === 0 ? ' border-red-500 bg-gray-200 text-gray-400' : 'bg-gray-400 text-gray-900 ' %> shadow-sm">
                  <input type="radio" name="size-choice" value="1" class="sr-only" aria-labelledby="size-choice-1-label"<%=user.size[1]<=0 ? 'disabled="disabled"':'' %> >
                  <span id="size-choice-1-label">7</span>
                  <span class="pointer-events-none absolute -inset-px rounded-md" aria-hidden="true"></span>
                </label>

                <label class="group relative flex items-center justify-center rounded-md border py-3 px-4 text-sm font-medium uppercase hover:bg-gray-50 focus:outline-none sm:flex-1 cursor-pointer <%= user.size[2] === 0 ? ' border-red-500 bg-gray-200 text-gray-400' : 'bg-gray-400 text-gray-900 ' %> shadow-sm">
                  <input type="radio" name="size-choice" value="2" class="sr-only" aria-labelledby="size-choice-2-label" <%=user.size[2] <=0 ? 'disabled="disabled"':'' %> >
                  <span id="size-choice-2-label">8</span>
                  <span class="pointer-events-none absolute -inset-px rounded-md" aria-hidden="true"></span>
                </label>

                <label class="group relative flex items-center justify-center rounded-md border py-3 px-4 text-sm font-medium uppercase hover:bg-gray-50 focus:outline-none sm:flex-1 cursor-pointer <%= user.size[3] === 0 ? ' border-red-500 bg-gray-200 text-gray-400' : 'bg-gray-400 text-gray-900 ' %> shadow-sm">
                  <input type="radio" name="size-choice" value="3" class="sr-only" aria-labelledby="size-choice-3-label" <%=user.size[3] <= 0 ? 'disabled="disabled"':'' %> >
                  <span id="size-choice-3-label">9</span>
                  <span class="pointer-events-none absolute -inset-px rounded-md" aria-hidden="true"></span>
                </label>

              </div>
            </fieldset>
          </div>
    </div>
    <p class="text-center text-red-500 font-bold" id="sizeError"><%=message%></p>

    </div>
    </div>
    </div>
    </div>
    <div class="py-6 mb-6 border-t border-b border-gray-200 dark:border-gray-700">
    <span class="text-base text-gray-600 dark:text-gray-400">In Stock : <%=user.product_category%></span>
    <p class="mt-2 text-sm text-blue-500 dark:text-blue-200">Ships from china.
    <span class="text-gray-600 dark:text-gray-400">
    Most customers receive within 3-31 days.
    </span>
    </p>
    </div>
    <div class="mb-6 "></div>
    <div class="flex flex-wrap items-center mb-6 ">
    <!-- <div class="mb-4 mr-4 lg:mb-0 ">
    <div class="w-28">
    <div class="relative flex flex-row w-full h-10 bg-transparent rounded-lg ">
    <button class="w-20 h-full text-gray-600 bg-gray-100 border-r rounded-l outline-none cursor-pointer dark:border-gray-700 dark:hover:bg-gray-700 dark:text-gray-400 hover:text-gray-700 dark:bg-gray-300 hover:bg-gray-300">
    <span class="m-auto text-2xl font-thin">-</span>
    </button>
    <input type="number" class="flex items-center w-full font-semibold text-center text-gray-700 placeholder-gray-700 bg-gray-100 outline-none dark:text-gray-400 dark:placeholder-gray-400 dark:bg-gray-300 focus:outline-none text-md hover:text-black" placeholder="1">
    <button class="w-20 h-full text-gray-600 bg-gray-100 border-l rounded-r outline-none cursor-pointer dark:border-gray-700 dark:hover:bg-gray-700 dark:text-gray-400 dark:bg-gray-300 hover:text-gray-700 hover:bg-gray-300">
    <span class="m-auto text-2xl font-thin">+</span>
    </button>
    </div>
    </div>
    </div> -->
    <!-- wishlist -->
    <!-- <div class="mb-4 lg:mb-0">
    <button class="flex items-center justify-center w-full h-10 p-2 mr-4 text-gray-700 border border-gray-300 lg:w-11 hover:text-gray-50 dark:text-gray-200 dark:border-blue-600 hover:bg-blue-600 hover:border-blue-600 dark:bg-blue-600 dark:hover:bg-blue-500 dark:hover:border-blue-500 dark:hover:text-gray-100">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class=" bi bi-heart" viewBox="0 0 16 16">
    <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z">
    </path>
    </svg>
    </button>
    </div> -->
    <a  href="#" data-product-id="<%=user._id%>" id="firstLink" onclick="toggleLinks()" class="addToCart w-full px-4 py-3 text-center text-blue-600 bg-blue-100 border border-blue-600  dark:text-gray-900 dark:border-gray-900 dark:bg-gray-300 hover:bg-blue-700 hover:text-gray-900 dark:hover:bg-blue-300 lg:w-1/2 rounded-xl" >
    ADD TO Cart
    </a>
    <a href="/cart" id="secondLink" class="hidden w-full px-4 py-3 text-center text-blue-600 bg-blue-100 border border-blue-600 dark:text-gray-900 dark:border-gray-900 dark:bg-green-400 hover:bg-green-600 hover:text-gray-900 dark:hover:bg-green-500 lg:w-1/2 rounded-xl" onclick="toggleLinks()">SHOW CART</a>
  </div>
    <!-- <div class="flex gap-4 mb-6">
    <a href="#" class="w-full px-4 py-3 text-center text-gray-100 bg-blue-600 border border-transparent dark:border-gray-700 hover:border-blue-500 hover:text-blue-700 hover:bg-blue-100 dark:text-gray-900 dark:bg-gray-300 dark:hover:bg-blue-200 rounded-xl">
    Buy now</a>
    </div> -->
    </div>
    </div>

    </div>
    </div>
    </section>

    <!-- footer -->
<%- include("../partials/footer.ejs") %>

<!-- for the image -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    var mainImage = document.getElementById('mainImage');
    if (mainImage) {
      var thumbnailImages = document.querySelectorAll('.flex-wrap img');
      thumbnailImages.forEach(function (thumbnail) {
        thumbnail.addEventListener('click', function () {
          // Switch main image source to clicked thumbnail
          mainImage.src = this.src;
          // Call ElevateZoom update function to update zoom on the new image
          $(mainImage).ezPlus();
        });
      });
    }
  });
</script>

  <!-- for the zooming -->
<script>
     var mainImage = document.getElementById('mainImage');
     $(document).ready(function(){
          $("#mainImage").ezPlus();
        });
</script>


<script>
  function toggleLinks() {
    // Get the first and second <a> elements
    var firstLink = document.getElementById('firstLink');
    var secondLink = document.getElementById('secondLink');

    // Toggle visibility
    if (firstLink.style.display !== 'none') {
      firstLink.style.display = 'none';
      secondLink.style.display = 'inline';
      
    } 
  } 
</script>

<!-- Add to cart -->
<script>
    const sizeRadioButtons = document.querySelectorAll('input[name="size-choice"]');
    const sizeError = document.getElementById('sizeError');
    let selectedSize
// Add click event listener to each radio button
sizeRadioButtons.forEach(button => {
  button.addEventListener('click', function() {
    // Get the selected size
     selectedSize = this.value;
     sizeRadioButtons.forEach(btn => {
        btn.parentElement.classList.remove('bg-indigo-600', 'text-white');
      });

      button.parentElement.classList.add('bg-indigo-600', 'text-white');
  });
});
var productPriceElement = document.getElementById('productPrice');
var productPrice = productPriceElement.innerText.split('$ ')[1]; // Assuming the format is "$ value"

  const addToCart = document.querySelectorAll('.addToCart')
  addToCart.forEach((btn) => {
    btn.addEventListener('click', (e) => {
      e.preventDefault()
      const productId = btn.dataset.productId
      fetch('/cartPost', {
          method: 'POST',
          redirect: 'follow',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            productId,selectedSize ,productPrice
          })
        })
        .then(res => {
          if (res.redirected) {
            return window.location.href = redirectURL;
          } else {
            return res.json()
          }
        })
        .then(data => {
           if(data.succes){
            // sizeError.innerText = 'PLEASE SELECT SIZE'
            window.location.reload()
           }
        })
        .catch(err => console.log(err))


        
      Toastify({
          text: "Added to Cart",
          duration: 600,
          destination: "https://github.com/apvarun/toastify-js",
          newWindow: true,
          close: true,
          gravity: "top", // `top` or `bottom`
          position: "center", // `left`, `center` or `right`
          stopOnFocus: true, // Prevents dismissing of toast on hover
          style: {
            background: " #4CAF50  ",
          },
          onClick: function(){
            alert("Toast clicked!");
          }
        }).showToast();
        


    })
  })
</script>


</body>
</html>