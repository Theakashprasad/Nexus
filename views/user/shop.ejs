<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="dist/output.css">
</head>
<body class="w-screen overflow-x-hidden">
  <!-- source: https://github.com/mfg888/Responsive-Tailwind-CSS-Grid/blob/main/index.html -->
  
  <!-- for the nav -->
  <%- include("../partials/navbar.ejs") %>
  <div class=" flex">
 <!-- selectOption on the left -->
 <div class=" h-40 mt-28 ml-24">
<form action="/shop" method="post">
  <label for="selectOption" class="text-black mr-2 uppercase">Filter by Category:</label> <br>
  <select id="selectOption" name="selectOption" class="bg-white text-black px-2 py-1 rounded">
    <% cartData.forEach((list)=> { %>
      <option value="<%= list.product_category %>">
        <%= list.product_category %>
      </option>
      <% }) %>

  </select>

<!-- Your content goes here -->
<br>
<div class=" mt-12">
<label for="selectOption" class="text-black mr-2 uppercase">Sort by Price  :</label> <br>
<div class="my-4">
  <label class="inline-flex items-center">
    <input type="radio" class="form-radio text-blue-500" name="option1" value="1">
    <span class="ml-2">  Lower To Higher Price </span>
  </label>
</div>

<div class="my-4">
  <label class="inline-flex items-center">
    <input type="radio" class="form-radio text-green-500" name="option2" value="-1">
    <span class="ml-2"> Higher To Lower Price </span>
  </label>
</div>
</div>
  <button type="submit" id="applyBtn" class="bg-blue-500 text-white font-bold py-2 px-4 rounded">
    APPLY
  </button>
</form>
</div>



  <!-- content -->
<section id="Projects" class="w-fit  pt-24 pb-24 mx-auto grid grid-cols-1 lg:grid-cols-3 md:grid-cols-2 justify-items-center justify-center gap-y-20 gap-x-14 mt-10 mb-5">
  <% data.forEach(user=>{ %>
    <div class="w-72 bg-white shadow-md rounded-xl duration-500 hover:scale-105 hover:shadow-xl">
        <a href="/product/<%= user._id %>">
          <img id="mainImage" src="<%=user.product_img_url[0]%>" alt="Nike Vomero 5 Men's Shoes" style="object-fit: contain;">
        </a>
          <div class="px-4 py-3 w-72">
                <span class="text-gray-400 mr-3 uppercase text-xs"><%=user.product_brand%></span>
                <p class="text-lg font-bold text-black truncate block capitalize"><%=user.product_name%></p>
                <div class="flex items-center">
                    <p class="text-lg font-semibold text-black cursor-auto my-3">$<%=user.product_price%></p>
                   
                    <div class="addToCart ml-auto bg-gray-300 font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline-blue active:bg-green-500 transition duration-300" data-item-id="<%=user._id%>">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"fill="currentColor" class="bi bi-bag-plus" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M8 7.5a.5.5 0 0 1 .5.5v1.5H10a.5.5 0 0 1 0 1H8.5V12a.5.5 0 0 1-1 0v-1.5H6a.5.5 0 0 1 0-1h1.5V8a.5.5 0 0 1 .5-.5z" />
                            <path d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1zm3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4h-3.5zM2 5h12v9a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V5z" />
                        </svg>
                      </div>
                      
                </div>
            </div>
     
    </div>
  <% }) %>
</section>
</div>


<section class="my-6">
  <div class="pagination flex justify-center gap-4">
    <% if (paginate.hasPreviousPages) { %>
      <a href="?page=<%= paginate.page - 1 %>"
        class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Previous</a>
      <% } %>

        <% if (paginate.hasNextPages && page < maxPage) { %>
          <a href="?page=<%= paginate.page + 1 %>"
            class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-700 focus:bg-blue-700 focus:outline-none transition duration-300 ease-in-out">
            Next
          </a>
          <% } %>

  </div>
  <p class="text-gray-900 font-bold items-center text-center "><%= paginate.page %> out of <%= maxPage %></p>

</section>
<!-- footer -->
<%- include("../partials/footer.ejs") %>
 
<!-- script for hovering -->
<script>
  kofiWidgetOverlay.draw('mohamedghulam', {
          'type': 'floating-chat',
          'floating-chat.donateButton.text': 'Support me',
          'floating-chat.donateButton.background-color': '#323842',
          'floating-chat.donateButton.text-color': '#fff'
      });
</script>

<script>
  const addToCart = document.querySelectorAll(".addToCart")
  addToCart.forEach(value => {
    value.addEventListener("click",(e)=>{
      console.log("hai");
      const productId = value.dataset.itemId
        // fetch("/cartPost",{
        //   method : 'POST',
        //   headers:{
        //     'Content-Type': 'application/json'
        //   },
        //   body : JSON.stringify({
        //       productId
        //   })
        // }).then(res=>res.json())
        // .then(data=>{
        //   console.log("sucess");
        // }).catch((Error)=>{
        //   console.log(Error);
        // })
      })
    
  });
</script>

<script>
  let selectedSortOption
  document.addEventListener('DOMContentLoaded', function () {
    // Add event listener to each radio input
    const radioInputs = document.querySelectorAll('input[type="radio"]');
    
    radioInputs.forEach(input => {
      input.addEventListener('change', function () {
        // Log the selected value to the console (you can replace this with your custom logic)
        console.log('Selected option:', this.value);
        selectedSortOption = this.value
      });
    });
  });


    function applyFunction() {
      console.log('ji');
      // Get the selected value of the filter dropdown
      const selectOption = document.getElementById('selectOption');
      const selectedCategory = selectOption.value;


      console.log('Selected Category:', selectedSortOption);
      fetch('/shop',{
        method: 'POST',
        headers:{
          'Content-Type': 'application/json'
        },
        body:JSON.stringify({selectedCategory,selectedSortOption})
      }).then(res=>res.json())
      .then((data)=>{
        if(data.sucess){
          window.location.reload()
        }
      })
      .catch(err=>console.log(err))
    }

</script>
</body>
</html>